# Azure scripts

## Настройки
 - Заменить DIGITAL_RESISTANCE_IMAGE в `cloud-init-ubuntu16.sh`
 - Установить [NodeJS 9](https://nodejs.org/en/)
 - Установить `npm i -g azure-cli` (TODO: избавиться потом)
 - Установить `brew install azure-cli` или `pip install azure-cli`
 - Указать resource-group (у меня называется tg). В `config.js`, `bin/launch-vm.sh` (TODO: конфиг из одного места)
 - Установить пакеты в папке azure `npm install`

## Команды

### `npm run list`
Выводит группированный список айпи по регионам

### `npm run launch <vm-suffix>`
Запускает машину в заданном внутри файла регионе(см настройки внутри файла `bin/launch-vm.sh`). В команде указывается только номер машины. Начинаем с 1 и увеличиваем дальше

TODO: доделать чтобы сразу запускал N машин в заданном регионе из агрумента

### `npm run rotate`
Авторотация IP по банлисту
- раз в час проходится по всем машинам внутри ресурс группы
- скачивает последние банлисты
- проверят айпи каждой машины на бан
- если есть бан то создает новый статик айпи и удаляет старый, перезагружает сервис

