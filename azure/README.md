# Azure scripts

## Настройки
 - Прокинуть энвы `BANLIST_TOKEN`, `BANLIST_SERVER`
 - Заменить DIGITAL_RESISTANCE_IMAGE в `cloud-init-ubuntu16.sh`
 - Проверить Python 3 `python3 --version`
 - Установить [NodeJS 9](https://nodejs.org/en/)
 - Установить пакеты в папке azure `npm install`

## Команды

### `npm run list`
Выводит группированный список айпи по регионам

### `npm run launch <vm-suffix>`
Запускает машину в заданном внутри файла регионе(см настройки внутри файла `bin/launch-vm.sh`). В команде указывается только номер машины. Начинаем с 1 и увеличиваем дальше

TODO: доделать чтобы сразу запускал N машин в заданном регионе из агрумента

### `npm run rotate`
Авторотация IP по банлисту
- раз в час проходится по всем машинам внутри ресурс группы
- скачивает последние банлисты
- проверят айпи каждой машины на бан
- если есть бан то создает новый статик айпи и удаляет старый, перезагружает сервис

